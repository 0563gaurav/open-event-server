{% extends 'gentelella/admin/event/event_base.html' %}
{% block title %}
    Edit Session - {{ event.name }}
{% endblock %}

{% set active_page = "sessions" %}

{% block head_css %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin/event_wizard.css') }}"/>
{% endblock %}

{% set textarea_session_fields = ['short_abstract', 'long_abstract', 'comments'] %}
{% set media_session_fields = ['slides', 'video', 'audio'] %}

{% set session_fields = ['title', 'subtitle', 'short_abstract', 'long_abstract', 'comments', 'track', 'session_type', 'language', 'slides', 'video', 'audio'] %}

{% macro session_form_field(identifier, require=0) %}
    {% set name = identifier | replace('_id','') %}
    {% set pretty_name = name | replace('_',' ') | capitalize %}
    <div class="item form-group speaker-fields">
        <label class="control-label">
            {{ pretty_name }}
            {% if require==1 %}
                <span class="required">*</span>
            {% endif %}
        </label>
        {% if identifier in textarea_session_fields %}
            <textarea {% if require==1 %}
                required="required"
            {% endif %}
                name="{{ identifier }}" class="form-control col-md-7 col-xs-12"></textarea>
        {% elif identifier in media_session_fields %}
            <br><input {% if require==1 %}
            required="required"
        {% endif %}
            type="file" id="speaker-file-{{ identifier | default(1) }}" name="{{ identifier }}"
            class="upload-btn"/>
            <label class="file-label" for="speaker-file-{{ identifier | default(1) }}">
                <i class="fa fa-cloud-upload" aria-hidden="true"></i>
                Choose a file</label>
        {% else %}
            <input {% if require==1 %}
                required="required"
            {% endif %}
                name="{{ identifier }}" class="form-control col-md-7 col-xs-12"
                {% if session[identifier] %}
                    value="{{ session[identifier] }}"
                {% endif %} />
        {% endif %}
    </div>
{% endmacro %}


{% block content %}
    <div class="row">

        <div class="col-md-12">
            <div style="text-align: center">
                <h3>Edit Session</h3>
            </div>

            <form enctype="multipart/form-data" name="test" action="" method="POST" role="form"
                  class="admin-form form-horizontal"
                  id="session-create-form">
                {% if csrf_token %}
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                {% endif %}
                <div class="row">
                    <div class="col-md-2 col-sm-2 col-xs-12">

                    </div>
                    <div class="col-md-8 col-sm-8 col-xs-12 session_form" style="margin-right: 25px;">
                        <h4>Session Details</h4>
                        {% for elem in session_fields %}
                            {% if session_form[elem].include==1 %}
                                {{ session_form_field(elem, session_form[elem].require) }}
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>
                <div class="row">
                    <div style="text-align: center;">
                        <button type="submit" class="btn btn-primary" name="state" value="draft">Save as Draft</button>
                        <button type="submit" class="btn btn-success" name="state" value="pending">Submit Session</button>
                    </div>
                </div>
            </form>
        </div>
    </div>


{% endblock %}
{% block tail_js %}
    {{ super() }}
    <script src="{{ url_for('static', filename='admin/lib/bootstrap-validator/dist/validator.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/admin/session/new.js') }}"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("textarea").summernote(summernoteConfig);
        });
    </script>
{% endblock %}
